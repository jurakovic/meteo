<!DOCTYPE html>
<html lang="hr-HR">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Meteo radari</title>
	<style>
		body {
			background-color: #212f45;
			font-family: monospace;
			min-height: 100vh;
			margin: 0px;
			padding: 0px;
		}

		.container {
			margin: 8px;
		}

		h2, a, td {
			color: white;
		}

		table {
			width: 100%;
			max-width: 875px;
			height: auto;
		}

		.placeholder {
			background-color: #202c40;
		}

		img {
			max-width: 100%;
			height: auto;
			display: block;
			border: 0;
		}

		.if1 {
			position: relative;
			width: 100%;
			overflow: hidden;
			padding-top: 80%;
		}

		.if2 {
			position: relative;
			width: 100%;
			overflow: hidden;
			padding-top: 115%;
		}

		.vid1 {
			position: relative;
			width: 100%;
			overflow: hidden;
			padding-top: 67%;
		}

		.vid2 {
			position: relative;
			width: 100%;
			overflow: hidden;
			padding-top: 87%;
		}

		iframe, video {
			position: absolute;
			top: 0;
			left: 0;
			bottom: 0;
			right: 0;
			width: 100%;
			height: 100%;
			border: none;
		}

		.sp {
			height: 10px;
		}

		.buttons {
			display: grid;
			grid-template-columns: 49.5% 49.5%;
			gap: 1%;
			font-size: 13px;
		}

			.buttons .btn {
				margin-top: 10px;
				margin-bottom: 5px;
				font-size: 13px;
				font-family: inherit;
				color: white;
				background-color: #485871;
				align-content: center;
				cursor: pointer;
				width: 100%;
				height: 24px;
				border: none;
				outline: none;
			}

				.buttons .btn:hover {
					background-color: #5F6F89;
				}

		.slideshow {
			position: relative;
			display: flex;
			justify-content: center;
		}

		.slide {
			display: none;
		}

			.slide.active {
				display: block;
			}

		.prev, .next {
			cursor: pointer;
			position: absolute;
			align-content: center;
			top: 0;
			bottom: 0;
			width: 15%;
			padding: 16px;
			color: transparent;
			opacity: 0.7;
			font-weight: bold;
			font-size: 36px;
			transition: 0.6s ease;
			user-select: none;
		}

		.prev {
			left: 0;
			text-align: left;
		}

			.prev:hover {
				background-image: linear-gradient(to left, transparent, rgba(0,0,0,0.6));
				color: white;
			}

			.prev.shorter {
				top: 0.4em;
			}

		.next {
			right: 0;
			text-align: right;
		}

			.next:hover {
				background-image: linear-gradient(to right, transparent, rgba(0,0,0,0.6));
				color: white;
			}

			.next.shorter {
				top: 0.4em;
			}

		.fade {
			animation-name: fade;
			animation-duration: 1s;
		}

		@keyframes fade {
			from {
				opacity: .6
			}

			to {
				opacity: 1
			}
		}

		@media (max-width: 800px) {
			.prev, .next {
				padding: 12px;
				font-size: 20px;
			}

				.prev.shorter, .next.shorter {
					top: 0.72em;
				}
		}

		.indicators-container {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 4px;
			width: 100%;
			margin-top: 1px;
		}

		.indicator {
			height: 3px;
			background-color: #5c5c5c80;
			transition: background-color 0.3s;
		}

			.indicator.active {
				background-color: #c7c7c7;
			}

		@media (max-width: 800px) {
			.indicator {
				height: 2px;
			}
		}

		.expandable {
			position: relative;
			justify-content: center;
			margin-top: 10px;
			margin-bottom: 4px;
			font-family: inherit;
			color: white;
			background-color: #485871;
			cursor: pointer;
			width: 100%;
			height: 24px;
			border: none;
			outline: none;
		}

			.expandable:hover {
				background-color: #5F6F89;
			}

			.expandable .arrow {
				position: absolute;
				right: 10px;
				top: 2px;
				font-size: 14px;
			}

		.links {
			font-size: 14px;
			display: grid;
			grid-template-columns: 25% 45% 30%;
			gap: 0;
			max-height: 0;
			overflow: hidden;
			transition: max-height 0.3s ease-out;
		}

			.links .item {
				padding: 5px;
				margin: 0 2px;
			}

				.links .item:not(:last-child) {
					border-right: 1px solid white;
				}

			.links p {
				margin-top: 0px;
				text-align: left;
			}

		@media (max-width: 800px) {
			.links {
				grid-template-columns: 1fr;
			}

				.links .item {
					margin: 5px 0;
					border-right: none !important;
				}
		}

		footer {
			position: sticky;
			top: 100%;
			background: #485871;
			color: white;
			text-align: center;
			padding: 8px;
			margin-top: 8px;
		}

		.progress-container {
			position: fixed;
			left: 0;
			bottom: 0;
			width: 100%;
			height: 2px;
			z-index: 1000;
			background-color: #5c5c5c80;
		}

		.progress-bar {
			width: 0;
			height: 100%;
			background-color: #4caf50;
			transition: width 0.3s ease-in-out;
		}
	</style>
	<script>
		function scrollToTop() {
			window.scrollTo({
				top: 0,
				behavior: 'smooth'
			});
		}

		function scrollToElement(id) {
			const element = document.getElementById(id);
			if (element) {
				element.scrollIntoView({
					behavior: 'smooth',
					block: 'start'
				});
			}
		}

		let slidePage = [2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];

		function plusSlides(slideshowId, n) {
			showSlides(slideshowId, slidePage[slideshowId - 1] += n);
		}

		function showSlides(slideshowId, n) {
			const slides = document.querySelectorAll(`.slideshow[data-slideshow-id="${slideshowId}"] .slide`);
			const indicators = document.querySelectorAll(`.indicators-container[data-slideshow-id="${slideshowId}"] .indicator`);
			if (n > slides.length) { slidePage[slideshowId - 1] = 1; }
			if (n < 1) { slidePage[slideshowId - 1] = slides.length; }
			slides.forEach(slide => slide.classList.remove('active'));
			slides[slidePage[slideshowId - 1] - 1].classList.add('active');
			indicators.forEach(indicator => indicator.classList.remove('active'));
			indicators[slidePage[slideshowId - 1] - 1].classList.add('active');
		}

		function handleSwipe(slideshowId, startX, endX) {
			const threshold = 50;
			const distance = endX - startX;

			if (Math.abs(distance) > threshold) {
				if (distance > 0) {
					plusSlides(slideshowId, -1); // swipe right
				} else {
					plusSlides(slideshowId, 1); // swipe left
				}
			}
		}

		window.addEventListener('load', function () {
			const lazyImages = document.querySelectorAll('img.lazy');

			lazyImages.forEach(img => {
				img.src = img.getAttribute('data-src');
				img.classList.remove('lazy');
			});
		});

		function showProgress() {
			// Get all images on the page
			const images = document.querySelectorAll('img');
			const progressBar = document.getElementsByClassName('progress-bar')[0];
			let imagesLoaded = 0;

			// Update progress bar
			const updateProgress = () => {
				const percent = (imagesLoaded / images.length) * 100;
				progressBar.style.width = percent + '%';

				// Hide the progress bar when all images are loaded
				if (imagesLoaded === images.length) {
					setTimeout(() => {
						document.getElementsByClassName('progress-container')[0].style.display = 'none';
					}, 500); // Hide after a short delay
				}
			};

			// Attach load and error events to each image
			images.forEach((img) => {
				img.addEventListener('load', () => {
					imagesLoaded++;
					updateProgress();
				});

				img.addEventListener('error', () => {
					imagesLoaded++; // Count error images as "loaded" to avoid getting stuck
					updateProgress();
				});

				if (img.complete) {
					img.dispatchEvent(new Event('load')); // Manually trigger 'load' if already loaded
				}
			});
		}

		function addSwipeEvents() {
			const slideshows = document.querySelectorAll('.slideshow');

			slideshows.forEach(slideshow => {
				let startX = 0;
				let startY = 0;
				let endX = 0;
				let endY = 0;
				let isDragging = false;
				const slideshowId = slideshow.getAttribute('data-slideshow-id');

				// Prevent default drag behavior on images
				const images = slideshow.querySelectorAll('img');
				images.forEach(img => {
					img.addEventListener('dragstart', (e) => e.preventDefault());
				});

				// Touch events for mobile
				slideshow.addEventListener('touchstart', (e) => {
					startX = e.touches[0].clientX;
					startY = e.touches[0].clientY;
					isDragging = false;
				});

				slideshow.addEventListener('touchmove', (e) => {
					endX = e.touches[0].clientX;
					endY = e.touches[0].clientY;

					// If the finger moves horizontally, set isDragging to true
					if (Math.abs(endX - startX) > Math.abs(endY - startY)) {
						isDragging = true;
					}
				});

				slideshow.addEventListener('touchend', () => {
					if (isDragging) {
						const deltaX = endX - startX;
						const deltaY = endY - startY;

						// Only trigger swipe if horizontal movement is greater than vertical movement (prevent swipe on scroll up or down)
						if (Math.abs(deltaX) > Math.abs(deltaY)) {
							handleSwipe(slideshowId, startX, endX);
						}
					}
				});

				// Mouse events for desktop
				slideshow.addEventListener('mousedown', (e) => {
					startX = e.clientX;
					startY = e.clientY;
					isDragging = true;
				});

				slideshow.addEventListener('mousemove', (e) => {
					if (isDragging) {
						endX = e.clientX;
						endY = e.clientY;
					}
				});

				slideshow.addEventListener('mouseup', (e) => {
					if (isDragging) {
						endX = e.clientX;
						endY = e.clientY;
						const deltaX = endX - startX;
						const deltaY = endY - startY;

						// Only trigger swipe if horizontal movement is greater than vertical movement (prevent swipe on scroll up or down)
						if (Math.abs(deltaX) > Math.abs(deltaY)) {
							handleSwipe(slideshowId, startX, endX);
						}
						isDragging = false;
					}
				});

				// Handle mouse leaving the slideshow area
				slideshow.addEventListener('mouseleave', () => {
					if (isDragging) {
						isDragging = false;
					}
				});
			});
		}

		document.addEventListener('DOMContentLoaded', showProgress);
		document.addEventListener('DOMContentLoaded', addSwipeEvents);
	</script>
	<script>
		function includeHTML() {
			const elements = document.querySelectorAll('[data-include-html]');
			elements.forEach(element => {
				const file = element.getAttribute('data-include-html');
				if (file) {
					fetch(file)
						.then(response => {
							if (!response.ok) throw new Error('Network response was not ok');
							return response.text();
						})
						.then(data => {
							element.innerHTML = data;
							element.removeAttribute('data-include-html');
							includeHTML(); // Recursive call to handle nested includes
						})
						.catch(error => console.error('Error fetching HTML fragment:', error));
				}
			});
		}

		async function addExpandableClickEventListener() {
			var expandable = document.getElementsByClassName("expandable")[0];
			expandable.addEventListener("click", function () {
				let arrow = this.querySelector(".arrow");
				var content = document.getElementsByClassName("links")[0];
				if (content.style.maxHeight) {
					content.style.maxHeight = null;
					arrow.textContent = "▼";
				} else {
					content.style.maxHeight = content.scrollHeight + "px";
					arrow.textContent = "▲";
					setTimeout(() => {
						// reset smooth scrolling to make it work every time
						document.documentElement.style.scrollBehavior = "auto";
						document.body.style.scrollBehavior = "auto";

						// apply smooth scroll
						scrollToElement('links');

						// re-enable smooth scrolling after a short delay
						setTimeout(() => {
							document.documentElement.style.scrollBehavior = "smooth";
							document.body.style.scrollBehavior = "smooth";
						}, 50);
					}, 310);
				}
			});
		}

		//document.addEventListener('DOMContentLoaded', includeHTML);
		document.addEventListener('DOMContentLoaded', addExpandableClickEventListener);

		window.addEventListener('load', () => {
			let iframe = document.getElementById('windyFrame');
			let url = new URL(iframe.src);

			console.log(window.innerWidth);

			if (window.innerWidth < 800) {
				url.searchParams.set('zoom', 6);
				iframe.src = url.toString();
			}

			iframe = document.getElementById('blitzortungFrame');
			url = iframe.src;
			console.log(iframe.src);
			console.log(url);
  
			if (window.innerWidth < 800) {
				url = url.replace('#6/44.5/16.5', '#5/44.5/16.5')
				console.log(url);
				iframe.src = url;
			}
		});

	</script>
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-233EMZJM16"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());
		gtag('config', 'G-233EMZJM16');
	</script>
</head>
<body>
	<div class="container">
		<h2 align="center">Meteo radari</h2>
		<hr>
		<table border="0" align="center" cellpadding="0" cellspacing="0">
			<tr>
				<td align="center">
					<div class="buttons">
						<a href="/meteo/extras/" style="text-decoration: none"><div class="btn">Više</div></a>
						<button type="button" class="btn" onclick="scrollToElement('links')">Linkovi</button>
					</div>
				</td>
			</tr>
			<tr class="sp"></tr>

			<tr>
				<td align="center">
					<a href="https://www.windy.com/-Radar-lightning-radar?radar,44.5,16.5,8" target="_blank" rel="nofollow">Windy</a>
					<div class="if1 placeholder">
						<iframe id="windyFrame" loading="lazy" src="https://embed.windy.com/embed2.html?lat=44.5&lon=16.56&zoom=7&level=surface&overlay=radar&menu=&message=true&marker=&calendar=&pressure=&type=map&location=coordinates&detail=&detailLat=45.798&detailLon=15.936&metricWind=m%2Fs&metricTemp=%C2%B0C&radarRange=-1" frameborder="0"></iframe>
					</div>
				</td>
			</tr>
			<tr class="sp"></tr>

			<tr>
				<td align="center">
					<a href="https://map.blitzortung.org/#6/44.5/16.5" target="_blank" rel="nofollow">Blitzortung.org | Munje</a>
					<div class="if1 placeholder">
						<iframe id="blitzortungFrame" loading="lazy" src="https://map.blitzortung.org/index.php?interactive=0&NavigationControl=0&FullScreenControl=0&Cookies=0&InfoDiv=1&MenuButtonDiv=0&ScaleControl=1&LinksCheckboxChecked=0&LinksRangeValue=0&MapStyle=1&MapStyleRangeValue=3&Advertisment=0#6/44.5/16.5" frameborder="0"></iframe>
					</div>
				</td>
			</tr>
			<tr class="sp"></tr>

		</table>
		<div class="progress-container">
			<div class="progress-bar"></div>
		</div>
	</div>
</body>
</html>
